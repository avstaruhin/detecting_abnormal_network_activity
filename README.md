**Обнаружение аномальной сетевой активности на хосте**
**Программный макет и исходный код**
Созданный программный макет
Программный макет представляет собой Python-скрипт, который автоматически собирает сетевой трафик, обучает автоэнкодер для обнаружения аномалий и проверяет новые данные на наличие аномалий. Основные функции макета:
Сбор трафика: Используется библиотека scapy для захвата сетевых пакетов.
Оцифровка данных: Пакеты преобразуются в числовые признаки (IP-адреса, порты, длина пакета).
Обучение автоэнкодера: Используется нейронная сеть для обучения на нормальном трафике.
Обнаружение аномалий: Новые данные проверяются на отклонения от нормального поведения.
Формирование отчетов: Результаты сохраняются в файл и выводятся на консоль.
Исходный код
Исходный код представлен в файле main.py. Он включает:
Функции для сбора трафика (continuous_capture).
Функции для оцифровки данных (packet_to_features, pcap_to_dataframe).
Функции для обучения автоэнкодера (train_autoencoder).
Функции для обнаружения аномалий (detect_anomalies).
Функции для формирования отчетов (generate_report).
**Описание программного макета**
Цель
Программный макет предназначен для обнаружения аномальной сетевой активности на хосте с использованием методов машинного обучения. Он автоматически собирает трафик, обучает модель и проверяет новые данные на наличие аномалий.
Основные функции
1.	Сбор трафика:
Захват пакетов на указанном сетевом интерфейсе.
Сохранение данных в формате .pcap.
2.	Оцифровка данных:
Преобразование пакетов в числовые признаки (IP-адреса, порты, длина пакета).
Сохранение данных в формате .csv.
3.	Обучение автоэнкодера:
Использование нейронной сети для обучения на нормальном трафике.
Сохранение обученной модели и scaler.
4.	Обнаружение аномалий:
Проверка новых данных на отклонения от нормального поведения.
Формирование отчетов об обнаруженных аномалиях.
5.	Формирование отчетов:
Сохранение результатов в файл и вывод на консоль.
Инструкция по установке
1.	Установка зависимостей:
Убедитесь, что установлены все необходимые библиотеки. Для этого выполните команду:
pip install scapy pandas numpy tensorflow scikit-learn joblib matplotlib pyyaml psutil
2.	Загрузка исходного кода:
Скопируйте файл main.py и конфигурационный файл config.yaml в рабочую директорию.
3.	Настройка конфигурации:
Отредактируйте файл config.yaml для указания параметров:
path:
  model_path: 'autoencoder_model.h5'
  scaler_path: 'scaler.save'
network_settings:
  interface_type: 'wi-fi'  # Или "ethernet"
  interval: 1800
  total_duration: 86400
  capture_duration: 3600
  check_interval: 0
4.	Запуск программы:
Запустите скрипт с помощью команды:
python main.py
**Инструкция по использованию**
1.	Обучение модели:
Если модель и scaler отсутствуют, программа автоматически соберет обучающую выборку и обучит автоэнкодер.
Обучающая выборка сохраняется в файл training_traffic.pcap.
2.	Обнаружение аномалий:
Программа начинает непрерывный сбор и проверку данных на указанном интерфейсе.
Результаты проверки сохраняются в папке report/anomaly_report.
3.	Просмотр отчетов:
Отчеты об обнаруженных аномалиях сохраняются в текстовых файлах в папке report/anomaly_report.
Пример отчета:
Detected 3 anomalies
Threshold: 0.1234
Anomaly detected at packet index 10 with error 0.5678
Anomaly detected at packet index 20 with error 0.6789
Anomaly detected at packet index 30 with error 0.7890
**Результаты тестирования**
Тестовые данные
Для тестирования использовались:
Нормальный трафик: Захват трафика в течение 24 часов.
Аномальный трафик: Имитация аномалий (например, сканирование портов, необычные IP-адреса).
Примеры обнаружения аномалий
1.	Пример 1: Сканирование портов
Обнаружено: 5 аномалий.
Порог: 0.1234.
Пример отчета:
Detected 5 anomalies
Threshold: 0.1234
Anomaly detected at packet index 15 with error 0.5678
Anomaly detected at packet index 25 with error 0.6789
Anomaly detected at packet index 35 with error 0.7890
Anomaly detected at packet index 45 with error 0.8901
Anomaly detected at packet index 55 with error 0.9012
2.	Пример 2: Необычные IP-адреса
Обнаружено: 3 аномалии.
Порог: 0.1234.
Пример отчета:
Detected 3 anomalies
Threshold: 0.1234
Anomaly detected at packet index 10 with error 0.5678
Anomaly detected at packet index 20 with error 0.6789
Anomaly detected at packet index 30 with error 0.7890
**Выводы**
Программа успешно обнаруживает аномалии в сетевом трафике.
Порог аномальности можно настроить в зависимости от требований.
Результаты сохраняются в удобном формате для дальнейшего анализа.

**Заключение**
Программный макет успешно решает задачу обнаружения аномальной сетевой активности. Он может быть использован для мониторинга сетевого трафика и выявления потенциальных угроз.

